<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrar Ponto de Acesso - PowerTrackZ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <a href="/" class="navbar-brand">PowerTrackZ</a>
            <ul class="navbar-nav">
                <li class="nav-item"><a href="/" class="nav-link">Início</a></li>
                <li class="nav-item"><a href="/hosts" class="nav-link">Hosts</a></li>
                <li class="nav-item"><a href="/register" class="nav-link active">Registrar</a></li>
            </ul>
        </div>
    </nav>

    <main class="page-register">
        <div class="container">
            <div class="register-grid">
                <!-- Coluna Esquerda: Tabela -->
                <section class="table-section">
                    <div class="header-table">
                        <h2 class="card-title">
                            <i class="fas fa-list"></i>
                            Pontos de Acesso Registrados
                        </h2>
                        <button class="btn btn-primary" id="btn-add-point">
                            <i class="fas fa-plus-circle"></i> Adicionar Ponto de Acesso
                        </button>
                    </div>
                    <div class="card">
                        <div class="table-wrapper">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Descrição</th>
                                        <th>Coordenadas</th>
                                        <th>Frequência</th>
                                        <th>Banda</th>
                                        <th>Canal</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for point in points %}
                                    <tr>
                                        <td><i class="fas fa-wifi"></i> {{ point.description }}</td>
                                        <td><span class="coords">{{ point.latitude }}, {{ point.longitude }}</span></td>
                                        <td>{{ point.frequency }} GHz</td>
                                        <td>{{ point.bandwidth }} MHz</td>
                                        <td>{{ point.channel }}</td>
                                        <td>
                                            <button class="action-button" onclick="showPointDetails('{{ point.id }}')">
                                                <i class="fas fa-info-circle"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Coluna Direita: Mapa -->
                <section class="map-section">
                    <div class="card">
                        <h2 class="card-title">
                            <i class="fas fa-map-marked-alt"></i>
                            Mapa de Pontos de Acesso
                        </h2>
                        <div class="map-container">
                            {% if map_html %}
                            <div class="map-content">
                                {{ map_html|safe }}
                            </div>
                            {% else %}
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i>
                                Não foi possível carregar o mapa. Por favor, tente novamente mais tarde.
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- Modal de Adição de Ponto de Acesso -->
        <div id="modal-add-point" class="modal" style="display:none;">
            <div class="modal-content">
                <span class="close" id="close-modal">&times;</span>
                <h2>Novo Ponto de Acesso</h2>
                <form id="form-add-point" action="{{ url_for('routes.register') }}" method="post">
                    <div class="form-group">
                        <label for="modal-latitude">Latitude</label>
                        <input type="text" id="modal-latitude" name="latitude" required readonly>
                    </div>
                    <div class="form-group">
                        <label for="modal-longitude">Longitude</label>
                        <input type="text" id="modal-longitude" name="longitude" required readonly>
                    </div>
                    <div class="form-group">
                        <label for="modal-description">Descrição</label>
                        <input type="text" id="modal-description" name="description" required>
                    </div>
                    <div class="form-group">
                        <label for="modal-frequency">Frequência (GHz)</label>
                        <input type="text" id="modal-frequency" name="frequency" required>
                    </div>
                    <div class="form-group">
                        <label for="modal-bandwidth">Largura (MHz)</label>
                        <input type="text" id="modal-bandwidth" name="bandwidth" required>
                    </div>
                    <div class="form-group">
                        <label for="modal-channel">Canal</label>
                        <input type="number" id="modal-channel" name="channel" min="1" max="165" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Registrar</button>
                </form>
            </div>
        </div>
    </main>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="{{ url_for('static', filename='js/register.js') }}"></script>
    <script src="{{ url_for('static', filename='js/map.js') }}"></script>
</body>
</html>